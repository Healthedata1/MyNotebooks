<!-- pas_bundle_to_cdex_task.md
  *****************************************************************************************************
  *                                  WARNING: DO NOT EDIT THIS FILE                                   *
  *                                                                                                   *
  * This file is generated by csv_to_markdown_tabler.ipynb. Any edits you make to this file will be   *
  * overwritten                                                                                       *
  * To change the contents of this file, edit input/images/data-element-mapping.csv                     *
  *****************************************************************************************************
  -->

| Data Element | CDex Request Attachment Task Profile Element | PAS Response Bundle Mapping to $submit-attachment Description | FHIRPath mapping to $submit-attachment  | PAS Response Bundle Mapping to $submit-attachment Comments  |
|---|-----|-----------------------|-----------------------------------------------------------|---------------------------------------------------|
| Tracking ID | Task.identifier | The ClaimResponse's first identifier element | Bundle.entry[0].resource.identifier[0]  | Maps to the "Patient Event Trace Number" in X12 278R  |
| Use | Task.reasonCode | Fixed to "preauthorization" | Fixed to "preauthorization"  | Fixed to "preauthorization"  |
| Payer ID | Task.requester.identifier | The first identifier element of the Organization referenced by the ClaimResponse's insurer element. | Bundle.entry.where(fullUrl = %context.entry[0].resource.insurer.reference or (resource.resourceType = 'Organization' and resource.id =%context.entry[0].resource.insurer.reference.split('/').last())).resource.identifier[0]  | FHIRPath for absolute and relative references. Using the FHIRPath function. "resolve()" which is not universally supported and untested: "Bundle.entry[0].resource.insurer.resolve().resource.identifier[0] |
| Payer URL | "PayerUrl" Task.input | - | -  | See the [Endpoint Discovery Strategy](https://hl7.org/fhir/us/davinci-hrex/endpoint-discovery.html) documented in the Da Vinci Health Record Exchange (HRex) Impelementation guide |
| Organization ID | PractitionerRole.practitioner.identifier | If present, the first identifier element of the Organization referenced by the ClaimResponse's requester element or the first identifier element of the Organization referenced by the organization element of the PractitiionerRole referenced by the ClaimResponse's requester element. | Bundle.entry.where(resource.resourceType = 'Organization' and (fullUrl = %context.entry[0].resource.requester.reference or resource.id =%context.entry[0].resource.requester.reference.split('/').last() or (fullUrl = (%context.entry.where(resource.resourceType = 'PractitionerRole' and (fullUrl = %context.entry[0].resource.requester.reference or resource.id = %context.entry[0].resource.requester.reference.split('/').last())).resource.organization.reference) or resource.id = (%context.entry.where(resource.resourceType = 'PractitionerRole' and (fullUrl = %context.entry[0].resource.requester.reference or resource.id = %context.entry[0].resource.requester.reference.split('/').last())).resource.organization.reference).split('/').last()))).resource.identifier[0] | "The ClaimResponse's requester element has a choice of Organization and PractitionerRole target types. FHIRPath for absolute and relative references. Using the FHIRPath function. "resolve()" which in not universally supported and untested: "Bundle.entry.where(resource.resourceType = 'Organization' and (fulllUrl = %context.entry[0].resource.requester.reference or fulllUrl = %context.entry[0].resource.requester.resolve().organization.reference or resource.id = %context.entry[0].resource.requester.reference.split('/').last() or resource.id = %context.entry[0].resource.requester.resolve().organization.reference.split('/').last())).resource.identifier[0]" |
| Provider ID | PractitionerRole.organization.identifier | The first identifier element of the Practitioner referenced by the practitioner element of the PractitionerRole referenced by the ClaimResponse's requester element. | Bundle.entry.where(resource.resourceType = 'Practitioner' and (fullUrl = (%context.entry.where(resource.resourceType = 'PractitionerRole' and (fullUrl = %context.entry[0].resource.requester.reference or resource.id = %context.entry[0].resource.requester.reference.split('/').last())).resource.practitioner.reference) or resource.id = (%context.entry.where(resource.resourceType = 'PractitionerRole' and (fullUrl = %context.entry[0].resource.requester.reference or resource.id = %context.entry[0].resource.requester.reference.split('/').last())).resource.practitioner.reference).split('/').last())).resource.identifier[0] | The ClaimResponse's requester element has a choice of Organization and PractitionerRole target types. FHIRPath for absolute and relative references. Using the FHIRPath function. "resolve()" which in not universally supported and untested: "Bundle.entry.where(fullUrl = %context.entry[0].resource.requester.resolve().practitioner.reference or (resource.resourceType = 'Practitioner' and resource.id = %context.entry[0].resource.requester.resolve().practitioner.reference.split('/').last()).resource.identifier[0]" |
| Claim/PreAuth ID | Task.reasonReference.identifier | The first identifier element of the Claim referenced by the ClaimResponse's "request" element. | Bundle.entry.where(fullUrl = %context.entry[0].resource.request.reference or (resource.resourceType = 'Claim' and resource.id =%context.entry[0].resource.request.reference.split('/').last())).resource.identifier[0]  | FHIRPath for absolute and relative references. Using the FHIRPath function. "resolve()" which is not universally supported and untested: "Bundle.entry[0].resource.request.resolve().resource.identifier[0]" |
| Line Item(s) | “AttachmentsNeeded” Task.input.extension | The CommunicationRequest payload element "serviceLineNumber" extension. | Bundle.entry.where(fullUrl = %context.entry[0].resource.communicationRequest.reference or (resource.resourceType = 'CommunicationRequest' and resource.id =%context.entry[0].resource.communicationRequest.reference.split('/').last())).resource.payload.extension.where(url='http://hl7.org/fhir/us/davinci-pas/StructureDefinition/extension-serviceLineNumber').valuePositiveInt | The ClaimResponse's communicationRequest element references the CommunicationRequest resource in the PAS response Bundle. Will need to iterate through the payload items FHIRPath for absolute and relative references. Using the FHIRPath function. "resolve()" which is not universally supported and untested: "Bundle.entry[0].resource.communicationRequest.resolve().resource.payload.extension.where(url='http://hl7.org/fhir/us/davinci-pas/StructureDefinition/extension-serviceLineNumber').valuePositiveInt" |
| Attachment Code | “AttachmentsNeeded” Task.input | The CommunicationRequest payload element "contentModifier" extension. | Bundle.entry.where(fullUrl = %context.entry[0].resource.communicationRequest.reference or (resource.resourceType = 'CommunicationRequest' and resource.id =%context.entry[0].resource.communicationRequest.reference.split('/').last())).resource.payload.extension.where(url='http://hl7.org/fhir/us/davinci-pas/StructureDefinition/extension-contentModifier').valueCodeableConcept | The ClaimResponse's communicationRequest element references the CommunicationRequest resource in the PAS response Bundle. Will need to iterate through the payload items. FHIRPath for absolute and relative references. Using the FHIRPath function. "resolve()" which is not universally supported and untested: "Bundle.entry[0].resource.communicationRequest.resolve().resource.payload.extension.where(url='http://hl7.org/fhir/us/davinci-pas/StructureDefinition/extension-contentModifier').valueCodeableConcept" |
| Due Date | Task.restriction.period | ? | -  | ?  |
| Date of Service | “service-date” Task.input | The ClaimResponse "preAuthPeriod" element's start date. | Bundle.entry[0].resource.preAuthPeriod.start  | Date of Service maps to the event level, not the service detail ( Item level) effective dates.  |
| Member ID | Patient.identifier | The member identifier element of the Patient referenced by the ClaimResponse's "patient" element. | Bundle.entry.where(fullUrl = %context.entry[0].resource.patient.reference or (resource.resourceType = 'Patient' and resource.id =%context.entry[0].resource.patient.reference.split('/').last())).resource.identifier.where('MB' in type.coding.code)  | This identifier has a fixed type code of "MB". FHIRPath for absolute and relative references. Using the FHIRPath function. "resolve()" which is not universally supported and untested: "Bundle.entry[0].resource.patient.resolve().resource.identifier.where('MB' in type.coding.code)" |
{:.grid}

The data element mapping table is available as a [CSV](data-element-mapping.csv) and [Excel](data-element-mapping.xlsx) file.