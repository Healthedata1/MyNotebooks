<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<title>Enter your title here</title>
	</head>
	<body>
		<div xmlns="http://www.w3.org/1999/xhtml">
		<h3 id="title">CapabilityStatement for {{cs.title}}</h3>
			<p>{{cs.description}}</p>
			<ul>
				<li>FHIR Version: {{cs.fhirVersion}}</li>
				<li>Supported formats: {{ cs.format | join(', ') }}</li>
				<li>Published: {{cs.date}}</li>
				<li>Published by: {{cs.publisher}}</li>
			</ul>
			<h4 id="behavior">FHIR RESTful Capabilities</h4>

			{{ cs.rest[0].documentation | markdown | safe }}
			<p id="security"><strong>Security:</strong></p>
			<p>{{cs.rest[0].security.description | markdown | safe }}</p>
			<h4 class="no_toc" id="resource--details">RESTful Capabilities by Resource/Profile:</h4>
			<hr/>
			<p><strong>Summary of {{cs.title}} search criteria</strong></p>
			<table class="grid">
				<thead>
					<tr>
						<th>Resource Type</th>
						<th>Supported Profiles</th>
						<th>Supported Searches</th>
						<th>Supported Includes</th>
					</tr>
				</thead>
				<tbody>
					{% for r in cs.rest[0].resource %}
					<tr>
						<td>
							<a href="#{{r.type | lower }}">{{r.type}}</a>
						</td>
						<td>
							{% for p in r._supportedProfile %}
							{{ p.extension[0].valueString }}
							{%- if not loop.last %}, {% endif %}
							{%- endfor %}
						</td>
						<td>
							{% for s in r.searchParam %}
							{{ s.name }}
							{%- if not loop.last %}, {% endif %}
							{%- endfor %}
							{%- for s in r.extension %}
							{%- if s.url == "http://hl7.org/fhir/StructureDefinition/capabilitystatement-search-parameter-combination" %}
							{%- for combo in s.extension -%}
							{{ combo.valueString }}
							{%- if not loop.last %}+{% endif %}
							{%- endfor %}
							{%- endif %}
							{%- if not loop.last %}, {% endif %}
							{%- endfor %}
						</td>
						<td/>
					</tr>
					{% endfor %}
				</tbody>
			</table>
			{% for r in cs.rest[0].resource %}
			<h4 class="no_toc" id="{{r.type | lower }}">{{r.type}}</h4>

			<p>Supported Profiles:
				{%- for p in r.supportedProfile -%}
				<a href="{{ p }}">
				{{ r._supportedProfile[loop.index0].extension[0].valueString }}</a>
				{%- if not loop.last %}, {% endif %}
				{%- endfor %}
				</p>

			<p>Fetch and Search Criteria:</p>
			<ol>
				{%- for i in r.interaction -%}
				{%- if i.code == "read" -%}
				<li>
					<p>A server <strong>{{ i.extension[0].valueCode }}</strong> be capable of returning a {{r.type}} resource using:</p>
					<p>
						<code class="highlighter-rouge">GET [base]/{{r.type}}/[id]</code>.</p>
				</li>
				{%-  endif %}
				{%- endfor %}
				{%- for s in r.searchParam -%}
				<li>
					<p>A server <strong>{{ s.extension[0].valueCode }}</strong> be capable of returning a {{r.type}} searched by the {{s.name}} parameter using</p>
					<p>
						<code class="highlighter-rouge">GET [base]/{{r.type}}?{{s.name}}=[system]|[code]</code>
					</p>
				</li>
				{%- endfor %}
				<li>
					<p>A server <strong>SHALL</strong>e capbable of returning a patient by supporting at a minimum the following search parameters when at least 2 are present:</p>
					<ul>
						<li>name</li>
						<li>gender</li>
						<li>
							<p>birthdate</p>
							<ul>
								<li>
									<p>for example:</p>
									<p>
										<code class="highlighter-rouge">GET [base]/Patient?name=[name]&amp;gender=[gender]</code>
									</p>
								</li>
							</ul>
						</li>
					</ul>
				</li>
			</ol>
			<p>Search Parameters:</p>
			<table class="grid">
				<thead>
					<tr>
						<th>Conformance</th>
						<th>Parameter</th>
						<th>Type</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>SHALL</td>
						<td>name</td>
						<td>string</td>
					</tr>
				</tbody>
			</table>
			{% endfor %}
		</div>
	</body>
</html>
